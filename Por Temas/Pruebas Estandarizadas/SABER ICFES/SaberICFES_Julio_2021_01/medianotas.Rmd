```{r data generation, echo = FALSE, results = "hide"}
library(exams)

mater<-sample(c("Química","Matemáticas","Tecnología"),1)
estud<-sample(c("Martha Lucía","María Consuelo","Carolina","Pedro","Antonia","Miguel","Mariana","Octavio","Milena","Violeta","Wilmer","Marleny","Diego","Dilma","Brayan","Sara","Diana","Katherine","Alexander"),1)
talleres<-round(sample(seq(from = 0.00, to = 5.00, by = 1), 1),1)
deftall<-round(talleres*0.3, 1)
asistencia<-round(sample(seq(from = 0.00, to = 5.00, by = 1), 1),1)
defasist<-round(asistencia*0.2, 1)
cumplim<-round(sample(seq(from = 0.00, to = 5.00, by = 1), 1),1)
defcumpli<-round(cumplim*0.1, 1)
otrasdef<-round((deftall+defasist+defcumpli),1)
##defdeseada<-round(sample(seq(from = 3.00, to = 5.00, by = 1), 1),1)
defdeseada<-3
obtener<-round(((defdeseada-otrasdef)/0.4),1)

if(obtener>5){
malas<-sample(seq(from = 3.0, to = 5.0, by = 0.5), 4)
malas2<-(obtener-max(malas))
malas3<-(obtener+max(malas))
malas4<-(obtener-min(malas))
aprrepr<-sample(c("aprobó", "reprobó"),1)
posib<-c("aun tiene posibilidades de aprobar")
posib

questions<-solutions<-explanations<-NULL
questions[1]<-paste(estud," debe obtener una nota de " ,obtener, " en evaluaciones, para lograr una nota definitiva de " ,defdeseada," en el área de " ,mater," lo que indica que ya reprobó esa área.")
solutions[1]<-TRUE
explanations[1]<-"."

questions[2]<-paste(estud," debe obtener una nota de " ,malas2, " en evaluaciones, para lograr una nota definitiva de " ,defdeseada," en " ,mater," lo que indica que ya " ,aprrepr, " esa área.")
solutions[2]<-FALSE
explanations[2]<-"."

questions[3]<-paste(estud," debe obtener una nota de " ,malas3, " en evaluaciones, para lograr una nota definitiva de " ,defdeseada," en " ,mater," lo que indica que ya" ,aprrepr, " esa área.")
solutions[3]<-FALSE
explanations[3]<-"."

questions[4]<-paste(estud," debe obtener una nota de " ,malas4, " en evaluaciones, para lograr una nota definitiva de " ,defdeseada," en " ,mater," lo que indica que ya " ,aprrepr, " esa área.")
solutions[4]<-FALSE
explanations[4]<-"."

  orden<-sample(1:4)
  questions<-questions[orden]
  solutions<-solutions[orden]
  explanations<-explanations[orden]
  
} else if(obtener<=5 & obtener>0){

malas<-sample(seq(from = 3.0, to = 4.0, by = 0.1), 4)
malas3<-round(obtener-max(malas),digits=1)
malas4<-(obtener-min(malas))
aprrepr<-sample(c("aprobó", "reprobó"),1)

questions<-solutions<-explanations<-NULL
questions[1]<-paste(estud," debe obtener una nota de " ,obtener, " en evaluaciones, para lograr una nota definitiva de " ,defdeseada," en " ,mater," lo que indica que aun tiene posibilidades de aprobar esa área.")
solutions[1]<-TRUE
explanations[1]<-"."

questions[2]<-paste(estud," debe obtener una nota de " ,obtener, " en evaluaciones, para lograr una nota definitiva de " ,defdeseada," en " ,mater," lo que indica que ya " ,aprrepr, " esa área.")
solutions[2]<-FALSE
explanations[2]<-"."

questions[3]<-paste(estud," debe obtener una nota de " ,malas3, " en evaluaciones, para lograr una nota definitiva de " ,defdeseada," en " ,mater," lo que indica que aun tiene posibilidades de aprobar esa área.")
solutions[3]<-FALSE
explanations[3]<-"."

questions[4]<-paste(estud," debe obtener una nota de " ,malas4, " en evaluaciones, para lograr una nota definitiva de " ,defdeseada," en " ,mater," lo que indica que ya " ,aprrepr, " esa área, porque la nota máxima para aprobar es 5.")
solutions[4]<-FALSE
explanations[4]<-"."

  orden<-sample(1:4)
  questions<-questions[orden]
  solutions<-solutions[orden]
  explanations<-explanations[orden]
  
} else if(obtener<=0){
malas<-sample(seq(from = 3.0, to = 4.0, by = 0.1), 4)
malas3<-(obtener-max(malas))
malas4<-(obtener/min(malas))
aprrepr<-sample(c("aprobó", "reprobó"),1)

questions<-solutions<-explanations<-NULL
questions[1]<-paste(estud," debe obtener una nota de " ,obtener, " en evaluaciones, para lograr una nota definitiva de " ,defdeseada," en " ,mater," lo que indica que ya aprobó esa área.")
solutions[1]<-TRUE
explanations[1]<-"."

questions[2]<-paste(estud," debe obtener una nota de " ,obtener, " en evaluaciones, para lograr una nota definitiva de " ,defdeseada," en " ,mater," lo que indica que ya " ,aprrepr, " esa área.")
solutions[2]<-FALSE
explanations[2]<-"."

questions[3]<-paste(estud," debe obtener una nota de " ,malas3, " en evaluaciones, para lograr una nota definitiva de " ,defdeseada," en " ,mater," lo que indica que ya " ,aprrepr, " esa área.")
solutions[3]<-FALSE
explanations[3]<-"."

questions[4]<-paste(estud," debe obtener una nota de " ,malas4, " en evaluaciones, para lograr una nota definitiva de " ,defdeseada," en " ,mater," lo que indica que ya " ,aprrepr, " esa área, porque la nota máxima para aprobar es 5.")
solutions[4]<-FALSE
explanations[4]<-"."

  orden<-sample(1:4)
  questions<-questions[orden]
  solutions<-solutions[orden]
  explanations<-explanations[orden]
}
```

Question
========

Al calcular la nota definitiva de `r mater` durante uno de los períodos académicos en la I. E. Pedacito de Cielo, `r estud` debe tener en cuenta la siguiente información: 

La nota de evaluaciones equivale al 40\% de la nota definitiva.\hfill \break
La nota de talleres equivale al 30\% de la nota definitiva.\hfill \break
La nota de asistencia equivale al 20\% de la nota definitiva.\hfill \break
La nota de cumplimiento equivale al 10\% de la nota definitiva.\hfill \break
El área de `r mater` se aprueba con una nota definitiva igual o mayor a 3\hfill \break
La nota máxima de calificación es 5.

Si la nota de `r estud` en talleres es de  `r talleres`, en asistencia es de `r asistencia` y, en cumplimiento es de `r cumplim`, ¿qué nota debe obtener `r estud` en evaluaciones, para que su nota definitiva en `r mater` sea de `r defdeseada`?



```{r questionlist, echo = FALSE, results = "asis"}
library(exams)
answerlist(questions, markup = "markdown")
```

Solution
========

```{r solutionlist, echo = FALSE, results = "asis"}
library(exams)
answerlist(ifelse(solutions, "True", "False"), markup = "markdown")
```

Meta-information
================
exname: Media Materia(single-choice)
extype: schoice
exsolution: `r mchoice2string(solutions)`