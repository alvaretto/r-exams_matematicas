```{r data generation, echo = FALSE, results = "hide", caption=" "}
library(exams)
require(stats)
library(ggplot2)
typ <- match_exams_device()

colores <-sample(c("plata","rojo","azul","blanco","negro","verde","gris","rosa","cian","violeta"),5,replace=F)

accidentados<-sample(seq(from = 5, to = 80, by = 5), 5,replace=F)

tablon <- data.frame(accidentados,colores)
head(tablon)

colbarra<-sample(c("red","green","black","gray","blue"),1)
colbarra

orden<- order(tablon$accidentados,decreasing = FALSE)
ordenado<-tablon[orden, ]
ordenado
menor<-ordenado[1,2]
menorv<-ordenado[1,1]
segundo<-ordenado[2,2]
tercero<-ordenado[3,2]
cuarto<-ordenado[4,2]
mayor<-ordenado[5,2]

cambio<-sample(c("alto","bajo"),1)
cambio

if(cambio=="alto"){
questions<-solutions<-explanations<-NULL
questions[1]<-paste("de los automóviles color " ,segundo," será el segundo del más bajo al más alto.")
solutions[1]<-FALSE
explanations[1]<-"."

questions[2]<-paste("de los automóviles color " ,mayor," será el más alto de todos.")
solutions[2]<-TRUE
explanations[1]<-"."

questions[3]<-paste("de los automóviles de cada color será el mismo.")
solutions[3]<-FALSE
explanations[1]<-"."

questions[4]<-paste("de los automóviles color ",menor," será el más alto de todos.")

solutions[4]<-FALSE
explanations[1]<-"."
orden<-sample(1:4)
questions<-questions[orden]
solutions<-solutions[orden]
explanations<-explanations[orden]

dibujo23 <- '
\\pgfplotsset{width=7cm,compat=1.17}
	\\begin{tikzpicture}
		\\begin{axis}[
			ybar,
			ymajorgrids,
			enlargelimits=0.15,
			width=10cm,
			legend style={at={(0.5,1.20)},
				anchor=north,legend columns=-1},
			ylabel={Accidentados \\%%},
			xlabel={Color de automóvil},
			symbolic x coords={%s,%s,%s,%s,%s},
			xtick=data,
			bar width=1cm,
			nodes near coords,
			nodes near coords align={vertical},
			x tick label style={rotate=0,anchor=north},
			]
			\\addplot [black,fill=%s] coordinates {(%s,%s) (%s,%s) (%s,%s) (%s,%s) (%s,%s)};
			\\legend{Accidentes de automóviles por color}
		\\end{axis}
	\\end{tikzpicture}
'
dibujo23 <- sprintf(dibujo23,colores[1],colores[2],colores[3],colores[4],colores[5],colbarra,colores[1],accidentados[1],colores[2],accidentados[2],colores[3],accidentados[3],colores[4],accidentados[4],colores[5],accidentados[5])
} else {
questions<-solutions<-explanations<-NULL
questions[1]<-paste("Como los vehículos color " ,menor," son los más vendidos, con un 35%, serán los más accidentados.")
solutions[1]<-FALSE
explanations[1]<-"."

questions[2]<-paste("Como los vehículos color " ,mayor," son los de mayor accidentalidad y, con 20% en ventas, serán los más accidentados.")
solutions[2]<-FALSE
explanations[1]<-"."

questions[3]<-paste("Como los vehículos color " ,mayor," solo tienen el 20% en ventas, tendrán menos accidentes que los de color ",cuarto," que tienen ventas superiores.")
solutions[3]<-FALSE
explanations[1]<-"."

questions[4]<-paste("Como los vehículos color " ,cuarto," se venden 10% menos que los de color ",menor," y no tienen una accidentalidad tan alta, se accidentarán menos que los de color ",menor,".")
solutions[4]<-TRUE
explanations[1]<-"."

orden<-sample(1:4)
questions<-questions[orden]
solutions<-solutions[orden]
explanations<-explanations[orden]

dibujo23 <- '
\\pgfplotsset{width=7cm,compat=1.17}
	\\begin{tikzpicture}
		\\begin{axis}[
			ybar,
			ymajorgrids,
			enlargelimits=0.15,
			width=10cm,
			legend style={at={(0.5,1.20)},
				anchor=north,legend columns=-1},
			ylabel={Accidentados \\%%},
			xlabel={Color de automóvil},
			symbolic x coords={%s,%s,%s,%s,%s},
			xtick=data,
			bar width=1cm,
			nodes near coords,
			nodes near coords align={vertical},
			x tick label style={rotate=0,anchor=north},
			]
			\\addplot [black,fill=%s] coordinates {(%s,%s) (%s,%s) (%s,%s) (%s,%s) (%s,%s)};
			\\legend{Accidentes de automóviles por color}
		\\end{axis}
	\\end{tikzpicture}
'
dibujo23 <- sprintf(dibujo23,colores[1],colores[2],colores[3],colores[4],colores[5],colbarra,colores[1],accidentados[1],colores[2],accidentados[2],colores[3],accidentados[3],colores[4],accidentados[4],colores[5],accidentados[5])  
}

pin<-sample
klrmayor<-

image23_3 <- '
\\begin{tikzpicture}
  \\node{
    \\begin{tabular}{|c|c|}
      \\hline
      \\textbf{Color} & \\textbf{Porcentaje de ventas} \\\\ \\hline
      {%s}      & {35}      \\\\ \\hline
      {%s}      & {25}      \\\\ \\hline
      {%s}      & {20}      \\\\ \\hline
      {%s}      & {10}      \\\\ \\hline
      {Otros colores} & {10}  \\\\ \\hline
    \\end{tabular}
  };
\\end{tikzpicture}
'
image23_3 <-sprintf(image23_3,menor,cuarto,mayor,segundo)
```
Question
========
\
Una universidad realizó un estudio para determinar si existe alguna relación entre el color de los automóviles y la seguridad vial. Del estudio se concluyó que el color `r menor` es el más seguro, pues por cada 100 autos de este color, `r menorv` fueron objeto de algún accidente.

\
Se obtuvo también la información de la gráfica, correspondiente al porcentaje de accidentalidad de automóviles de varios colores
\

```{r dibujo23, warning=FALSE,echo = FALSE, results = "asis"}
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
include_tikz(dibujo23, name = "dibujo_23_2", markup = "markdown",format = typ, library = c("3d", "babel"), packages=c("pgfplots","tikz","xcolor"),width = "8cm")
```

\
La compañía productora de pinturas publicó la información de la tabla sobre las preferencias de color en las ventas de carros.
\

```{r image23_3, warning=FALSE,echo = FALSE, results = "asis"}
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
include_tikz(image23_3, name = "grafik23_3", markup = "markdown",format = typ, library = c("3d", "babel"), packages=c("tikz","xcolor"),width = "7cm")
```

\
Respecto a la información anterior, ¿cuál de las siguientes afirmaciones es correcta?

```{r questionlist, echo = FALSE, results = "asis"}
library(exams)
answerlist(questions, markup = "markdown")
```

Solution
========
```{r solutionlist, echo = FALSE, results = "asis"}
library(exams)
answerlist(ifelse(solutions, "Verdadero", "Falso"), markup = "markdown")
```

Answerlist
----------
* Verdadero
* Falso
* Falso
* Falso

Meta-information
================
exname: BarrasConTikZ(single-choice)
extype: schoice
exsolution: `r mchoice2string(solutions)`