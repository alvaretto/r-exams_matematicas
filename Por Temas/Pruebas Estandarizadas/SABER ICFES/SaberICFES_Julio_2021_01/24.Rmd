```{r data generation, echo = FALSE, results = "hide", caption=" "}
library(exams)
require(stats)
library(ggplot2)
typ <- match_exams_device()

colores <-sample(c("plata","rojo","azul","blanco","negro","verde","gris","rosa","cian","violeta"),5,replace=F)

accidentados<-sample(seq(from = 5, to = 80, by = 5), 5,replace=F)
accidentados

tablon <- data.frame(accidentados,colores)
head(tablon)

colbarra<-sample(c("red","green","black","gray","blue"),1)
colbarra

orden<- order(tablon$accidentados,decreasing = FALSE)
orden
ordenado<-tablon[orden, ]
ordenado
menor<-ordenado[1,2]
menor
menorv<-ordenado[1,1]
menorv
segundo<-ordenado[2,2]
segundo
mayor<-ordenado[5,2]
mayor

cambio<-sample(c("alto","bajo"),1)
cambio

if(cambio=="alto"){
questions<-solutions<-explanations<-NULL
questions[1]<-paste("de los automóviles color " ,segundo," será el segundo del más bajo al más alto.")
solutions[1]<-FALSE
explanations[1]<-"."

questions[2]<-paste("de los automóviles color " ,mayor," será el más alto de todos.")
solutions[2]<-TRUE
explanations[1]<-"."

questions[3]<-paste("de los automóviles de cada color será el mismo.")
solutions[3]<-FALSE
explanations[1]<-"."

questions[4]<-paste("de los automóviles color ",menor," será el más alto de todos.")

solutions[4]<-FALSE
explanations[1]<-"."
orden<-sample(1:4)
questions<-questions[orden]
solutions<-solutions[orden]
explanations<-explanations[orden]

dibujo62 <- '
\\pgfplotsset{width=7cm,compat=1.18}
	\\begin{tikzpicture}
		\\begin{axis}[
			ybar,
			ymajorgrids,
			enlargelimits=0.15,
			width=10cm,
			legend style={at={(0.5,1.20)},
				anchor=north,legend columns=-1},
			ylabel={Accidentados \\%%},
			xlabel={Color de automóvil},
			symbolic x coords={%s,%s,%s,%s,%s},
			xtick=data,
			bar width=1cm,
			nodes near coords,
			nodes near coords align={vertical},
			x tick label style={rotate=0,anchor=north},
			]
			\\addplot [black,fill=%s] coordinates {(%s,%s) (%s,%s) (%s,%s) (%s,%s) (%s,%s)};
			\\legend{Accidentes de automóviles por color}
		\\end{axis}
	\\end{tikzpicture}
'
dibujo62 <- sprintf(dibujo62,colores[1],colores[2],colores[3],colores[4],colores[5],colbarra,colores[1],accidentados[1],colores[2],accidentados[2],colores[3],accidentados[3],colores[4],accidentados[4],colores[5],accidentados[5])
} else 
  {
questions<-solutions<-explanations<-NULL
questions[1]<-paste("de los automóviles color " ,segundo," será el segundo del más bajo al más alto.")
solutions[1]<-FALSE
explanations[1]<-"."

questions[2]<-paste("de los automóviles color " ,menor," será el más bajo de todos.")
solutions[2]<-TRUE
explanations[1]<-"."

questions[3]<-paste("de los automóviles de cada color será el mismo.")
solutions[3]<-FALSE
explanations[1]<-"."

questions[4]<-paste("de los automóviles color ",mayor," será el más bajo de todos.")

solutions[4]<-FALSE
explanations[1]<-"."
orden<-sample(1:4)
questions<-questions[orden]
solutions<-solutions[orden]
explanations<-explanations[orden]

dibujo62 <- '
\\pgfplotsset{width=7cm,compat=1.18}
	\\begin{tikzpicture}
		\\begin{axis}[
			ybar,
			ymajorgrids,
			enlargelimits=0.15,
			width=10cm,
			legend style={at={(0.5,1.20)},
				anchor=north,legend columns=-1},
			ylabel={Accidentados \\%%},
			xlabel={Color de automóvil},
			symbolic x coords={%s,%s,%s,%s,%s},
			xtick=data,
			bar width=1cm,
			nodes near coords,
			nodes near coords align={vertical},
			x tick label style={rotate=0,anchor=north},
			]
			\\addplot [black,fill=%s] coordinates {(%s,%s) (%s,%s) (%s,%s) (%s,%s) (%s,%s)};
			\\legend{Accidentes de automóviles por color}
		\\end{axis}
	\\end{tikzpicture}
'
dibujo62 <- sprintf(dibujo62,colores[1],colores[2],colores[3],colores[4],colores[5],colbarra,colores[1],accidentados[1],colores[2],accidentados[2],colores[3],accidentados[3],colores[4],accidentados[4],colores[5],accidentados[5])  
}
```

Question
========
\

Una universidad realizó un estudio para determinar si existe alguna relación entre el color de los automóviles y la seguridad vial. Del estudio se concluyó que el color `r menor` es el más seguro, pues por cada 100 autos de este color, `r menorv` fueron objeto de algún accidente.

\
Se obtuvo también la información de la gráfica, correspondiente al porcentaje de accidentalidad de automóviles de varios colores
\

```{r dibujo62, warning=FALSE,echo = FALSE, results = "asis"}
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
include_tikz(dibujo62, name = "dibujo_62", markup = "markdown",format = typ, library = c("3d", "babel"), packages=c("pgfplots","xcolor","tikz"),width = "8cm")
```

\
El Ministerio de Transporte, basado en esta información, quiere implementar una estrategia para bajar la tasa de accidentalidad. Para esto, exigirá adquirir un seguro cuyo valor a pagar por el propietario será proporcional al porcentaje de accidentalidad del color del automóvil.

\
Teniendo en cuenta la información de la gráfica, es correcto afirmar que el valor a pagar del seguro

```{r questionlist, echo = FALSE, results = "asis"}
library(exams)
answerlist(questions, markup = "markdown")
```

Solution
========
```{r solutionlist, echo = FALSE, results = "asis"}
library(exams)
answerlist(ifelse(solutions, "Verdadero", "Falso"), markup = "markdown")
```

Meta-information
================
exname: BarrasConTikZ(single-choice)
extype: schoice
exsolution: `r mchoice2string(solutions)`