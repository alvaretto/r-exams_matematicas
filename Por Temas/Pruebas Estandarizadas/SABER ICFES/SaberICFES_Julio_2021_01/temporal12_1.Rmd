```{r data generation, echo = FALSE, results = "hide"}
library(exams)
typ <- match_exams_device()

xsubio<-sample(c(9,10,11,12,13,14,15,16,17,18,19),5)
xsubi<-sort(xsubio)
xsubi
frecuencias<-sample(20:60 ,5)
frecuencias

tabla<-data.frame(xsubi,frecuencias)
colnames(tabla)<-c("Edad (en años)" ,"Alumnos")

total<-(frecuencias[1]+frecuencias[2]+frecuencias[3]+frecuencias[4]+frecuencias[5])

facum1<-frecuencias[1]
facum2<-facum1+frecuencias[2]
facum3<-facum2+frecuencias[3]
facum4<-facum3+frecuencias[4]
facum5<-facum4+frecuencias[5]

xif1<-rep(xsubi[1],frecuencias[1])
xif1
xif2<-rep(xsubi[2],frecuencias[2])
xif3<-rep(xsubi[3],frecuencias[3])
xif4<-rep(xsubi[4],frecuencias[4])
xif5<-rep(xsubi[5],frecuencias[5])
cmna<-c(xif1,xif2,xif3,xif4,xif5)
totalumnos<-length(cmna)
totalumnos
mna<-median(cmna)
prome<-round(mean(cmna),1)
csmoda<-max(frecuencias[])
if(csmoda==frecuencias[1]){
  moda<-xsubi[1]
}else if(csmoda==frecuencias[2]){
  moda<-xsubi[2]
}else if(csmoda==frecuencias[3]){
  moda<-xsubi[3]
}else if(csmoda==frecuencias[4]){
  moda<-xsubi[4]
}else
  moda<-xsubi[5]

image01 <- '
\\begin{tikzpicture}
  \\node{
    \\begin{tabular}{|c|c|}
      \\hline
      \\textbf{Edad (en años)} & \\textbf{Alumnos} \\\\ \\hline
      {%s}      & {%s}      \\\\ \\hline
      {%s}      & {%s}      \\\\ \\hline
      {%s}      & {%s}      \\\\ \\hline
      {%s}      & {%s}      \\\\ \\hline
      {%s}      & {%s}      \\\\ \\hline
    \\end{tabular}
  };
\\end{tikzpicture}
'
image01 <-sprintf(image01, xsubi[1], frecuencias[1], xsubi[2], frecuencias[2], xsubi[3], frecuencias[3], xsubi[4], frecuencias[4], xsubi[5], frecuencias[5])

if(mna>prome){

questions<-solutions<-explanations<-NULL
questions[1]<-paste("Sólo I.")
solutions[1]<-FALSE
explanations[1]<-"."

questions[2]<-paste("Sólo II.")
solutions[2]<-FALSE
explanations[1]<-"."

questions[3]<-paste("Sólo I y II.")
solutions[3]<-FALSE
explanations[1]<-"."

questions[4]<-paste("I, II y III .")
solutions[4]<-TRUE
explanations[1]<-"."

orden<-sample(1:4)
questions<-questions[orden]
solutions<-solutions[orden]
explanations<-explanations[orden]
}

if(mna<prome){
questions<-solutions<-explanations<-NULL
questions[1]<-paste("Sólo I.")
solutions[1]<-FALSE
explanations[1]<-"."

questions[2]<-paste("Sólo II.")
solutions[2]<-FALSE
explanations[1]<-"."

questions[3]<-paste("Sólo I y III.")
solutions[3]<-TRUE
explanations[1]<-"."

questions[4]<-paste("I, II y III .")
solutions[4]<-FALSE
explanations[1]<-"."

orden<-sample(1:4)
questions<-questions[orden]
solutions<-solutions[orden]
explanations<-explanations[orden]
}
```

Question
========
La tabla adjunta muestra las edades de `r totalumnos` alumnos de la Institución Educativa Pedacito de Cielo. ¿Cuál(es) de las siguientes afirmaciones es (son) verdadera(s)?
\

I. La moda es `r moda` años.\
II. La mediana es mayor que la media (promedio).\
III. La mitad de los alumnos del colegio tiene entre `r xsubi[1]` y `r mna` años.
\

```{r image01, warning=FALSE,echo = FALSE, results = "asis"}
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
include_tikz(image01, name = "grafiko7_58", markup = "markdown",format = typ, library = c("3d", "babel"), packages=c("tikz","xcolor"),width = "6cm")
```

Según esa información,

```{r questionlist, echo = FALSE, results = "asis"}
library(exams)
answerlist(questions, markup = "markdown")
```

Solution
========
```{r solutionlist, echo = FALSE, results = "asis"}
library(exams)
answerlist(ifelse(solutions, "Verdadero", "Falso"), markup = "markdown")
```

Meta-information
================
exname: EdadesColegioMMM(single-choice)
extype: schoice
exsolution: `r mchoice2string(solutions)`